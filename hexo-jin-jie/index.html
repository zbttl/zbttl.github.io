<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/bao32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/bao16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zbttl-github-io.vercel.app","root":"/","images":"/images","scheme":"Muse","version":"8.1.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="NexT 更新光 速 更 新（不是">
<meta property="og:type" content="article">
<meta property="og:title" content="hexo 进阶">
<meta property="og:url" content="https://zbttl-github-io.vercel.app/hexo-jin-jie/index.html">
<meta property="og:site_name" content="Bao&#39;s 备忘录">
<meta property="og:description" content="NexT 更新光 速 更 新（不是">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20201221175721.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20201222005052.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104030713.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104030940.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104031356.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104032640.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210113073831.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210113073930.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210113074220.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210217072142.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104051916.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104052701.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210124015247.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210124025621.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210226061535.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210226061627.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210124021027.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210124023841.png">
<meta property="article:published_time" content="2020-12-20T16:00:00.000Z">
<meta property="article:modified_time" content="2021-02-25T22:18:17.273Z">
<meta property="article:author" content="zbttl">
<meta property="article:tag" content="hexo">
<meta property="article:tag" content="NexT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20201221175721.png">


<link rel="canonical" href="https://zbttl-github-io.vercel.app/hexo-jin-jie/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<title>hexo 进阶 | Bao's 备忘录</title>
  



  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>


<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Bao's 备忘录" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Bao's 备忘录</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#NexT-%E6%9B%B4%E6%96%B0"><span class="nav-number">1.</span> <span class="nav-text">NexT 更新</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%84%E8%AE%BA%EF%BC%88%E4%B8%B4%E6%97%B6%EF%BC%89"><span class="nav-number">2.</span> <span class="nav-text">评论（临时）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%93%BE%E6%8E%A5%E4%B8%AD%E4%B8%AD%E6%96%87%E8%BD%AC%E6%8B%BC%E9%9F%B3%EF%BC%8C%E4%BB%A5%E5%8F%8A%E4%BF%AE%E6%94%B9-permalinks"><span class="nav-number">3.</span> <span class="nav-text">链接中中文转拼音，以及修改 permalinks</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSS"><span class="nav-number">4.</span> <span class="nav-text">RSS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%98%BE%E7%A4%BA%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4"><span class="nav-number">5.</span> <span class="nav-text">显示运行时间</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%84%E5%88%86"><span class="nav-number">6.</span> <span class="nav-text">评分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#markdown-emoji"><span class="nav-number">7.</span> <span class="nav-text">markdown emoji</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%AD%A3%E6%96%87%E5%AD%97%E4%BD%93%E5%A4%A7%E5%B0%8F"><span class="nav-number">8.</span> <span class="nav-text">修改正文字体大小</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%B7%E6%AD%8C%E7%99%BE%E5%BA%A6%E6%90%9C%E7%B4%A2%E6%94%B6%E5%BD%95"><span class="nav-number">9.</span> <span class="nav-text">谷歌百度搜索收录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%B7%E6%AD%8C"><span class="nav-number">9.1.</span> <span class="nav-text">谷歌</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BE%E5%BA%A6%EF%BC%88%E5%AD%98%E7%96%91%EF%BC%89"><span class="nav-number">9.2.</span> <span class="nav-text">百度（存疑）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E7%AB%99%EF%BC%8C%E4%BB%85%E4%BD%BF%E7%94%A8%E4%B8%BB%E5%8A%A8%E6%8E%A8%E9%80%81%E6%8F%90%E4%BA%A4%E9%A1%B5%E9%9D%A2"><span class="nav-number">9.2.1.</span> <span class="nav-text">不使用镜像站，仅使用主动推送提交页面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E7%AB%99"><span class="nav-number">9.2.2.</span> <span class="nav-text">使用镜像站</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E9%80%9F%E5%BA%A6%E4%BC%98%E5%8C%96"><span class="nav-number">10.</span> <span class="nav-text">加载速度优化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E8%BF%9E%E6%8E%A5%E6%8A%80%E6%9C%AF"><span class="nav-number">10.1.</span> <span class="nav-text">快速连接技术</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-Gulp-%E5%8E%8B%E7%BC%A9%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"><span class="nav-number">10.2.</span> <span class="nav-text">使用 Gulp 压缩静态资源</span></a></li></ol></li></ol></div>
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zbttl" src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">zbttl</p>
  <div class="site-description" itemprop="description">玩点好玩的</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">54</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">110</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zbttl" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zbttl" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zbttls@gmail.com" title="E-Mail → mailto:zbttls@gmail.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zbttl-github-io.vercel.app/hexo-jin-jie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="zbttl">
      <meta itemprop="description" content="玩点好玩的">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bao's 备忘录">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          hexo 进阶
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-21 00:00:00" itemprop="dateCreated datePublished" datetime="2020-12-21T00:00:00+08:00">2020-12-21</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-02-26 06:18:17" itemprop="dateModified" datetime="2021-02-26T06:18:17+08:00">2021-02-26</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%8D%9A%E5%AE%A2/" itemprop="url" rel="index"><span itemprop="name">博客</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>18k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>34 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="NexT-更新"><a href="#NexT-更新" class="headerlink" title="NexT 更新"></a>NexT 更新</h2><p>光 速 更 新（不是</p>
<p>啊我刚写完上一篇挑博客系统的时候发现 gitment 怎么都不生效，想想是不是 next 有其他的生效方法。。。摸到 next 项目的 md 那边才发现一个惊讶的事实：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20201221175721.png"></p>
<p>我上一篇用的是 7.8.0。。。原因啊，毕竟我也是看的人家的教程来学的，然后 clone 人家教程上面的 url 告诉我这个仓库的 NexT 过时了，显示了个新的仓库，我就直接摸过去了，谁知道还有更新的，佛了。</p>
<p>那就老老实实迁移吧，备份主题配置文件，删掉 themes 下的 NexT 主题，clone 新仓库的主题，</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp themes/next/_config.yml themes/_config.yml.bak</span><br><span class="line">rm -r themes/next</span><br><span class="line">git clone https://github.com/next-theme/hexo-theme-next.git themes/next</span><br></pre></td></tr></tbody></table></figure>

<p>然后用 vscode 对一下新 clone 下来的主题配置文件和备份的旧版主题配置文件的差别，把要改的地方怼过去。。。</p>
<p>慢！</p>
<p>根据 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://theme-next.js.org/docs/getting-started/configuration.html">Configuration</a>，咱们现在用的 hexo 5.0 已经支持这种新的配置方式了，说人话就是不用再进 <code>themes/next</code> 里面改配置了，只需要在全局主题里面加（并且在这些配置的开头顶上加 <code>theme_config</code> 并给这些配置一个两空格缩进），或者在 hexo 根目录新开一个 <code>_config.next.yml</code> 把要改的配置丢进去就完事了。有点像以前写过的 rime 输入法的 patch 文件。</p>
<p>按上一篇文章的功能来，大部分需要修改主题配置文件的地方我都抽取出来放在了<code>_config.next.yml</code> ，以下是代码参考：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"># Define custom file paths.</span><br><span class="line"># Create your custom files in site directory `source/_data` and uncomment needed files below.</span><br><span class="line">custom_file_path:</span><br><span class="line">  #head: source/_data/head.njk</span><br><span class="line">  #header: source/_data/header.njk</span><br><span class="line">  #sidebar: source/_data/sidebar.njk</span><br><span class="line">  #postMeta: source/_data/post-meta.njk</span><br><span class="line">  #postBodyEnd: source/_data/post-body-end.njk</span><br><span class="line">  footer: source/_data/footer.njk</span><br><span class="line">  bodyEnd: source/_data/body-end.njk</span><br><span class="line">  #variable: source/_data/variables.styl</span><br><span class="line">  #mixin: source/_data/mixins.styl</span><br><span class="line">  #style: source/_data/styles.styl</span><br><span class="line"></span><br><span class="line">creative_commons:</span><br><span class="line">  license: by-sa</span><br><span class="line">  sidebar: false</span><br><span class="line">  post: true</span><br><span class="line">  language:</span><br><span class="line"></span><br><span class="line">menu:</span><br><span class="line">  home: / || fa fa-home</span><br><span class="line">  tags: /tags/ || fa fa-tags</span><br><span class="line">  categories: /categories/ || fa fa-th</span><br><span class="line">  archives: /archives/ || fa fa-archive</span><br><span class="line">  #schedule: /schedule/ || fa fa-calendar</span><br><span class="line">  #sitemap: /sitemap.xml || fa fa-sitemap</span><br><span class="line">  #commonweal: /404/ || fa fa-heartbeat</span><br><span class="line">  about: /about/ || fa fa-user</span><br><span class="line"></span><br><span class="line">social:</span><br><span class="line">  GitHub: https://github.com/zbttl || fab fa-github</span><br><span class="line">  E-Mail: mailto:zbttls@gmail.com|| fa fa-envelope</span><br><span class="line">  #Weibo: https://weibo.com/yourname || fab fa-weibo</span><br><span class="line">  #Google: https://plus.google.com/yourname || fab fa-google</span><br><span class="line">  #Twitter: https://twitter.com/yourname || fab fa-twitter</span><br><span class="line">  #FB Page: https://www.facebook.com/yourname || fab fa-facebook</span><br><span class="line">  #StackOverflow: https://stackoverflow.com/yourname || fab fa-stack-overflow</span><br><span class="line">  #YouTube: https://youtube.com/yourname || fab fa-youtube</span><br><span class="line">  #Instagram: https://instagram.com/yourname || fab fa-instagram</span><br><span class="line">  #Skype: skype:yourname?call|chat || fab fa-skype</span><br><span class="line"></span><br><span class="line">footer:</span><br><span class="line">  # Specify the year when the site was setup. If not defined, current year will be used.</span><br><span class="line">  #since: 2020</span><br><span class="line"></span><br><span class="line">  # Icon between year and copyright info.</span><br><span class="line">  icon:</span><br><span class="line">    # Icon name in Font Awesome. See: https://fontawesome.com/icons</span><br><span class="line">    name: fa fa-heart</span><br><span class="line">    # If you want to animate the icon, set it to true.</span><br><span class="line">    animated: false</span><br><span class="line">    # Change the color of icon, using Hex Code.</span><br><span class="line">    color: "#ff0000"</span><br><span class="line"></span><br><span class="line">  # If not defined, `author` from Hexo `_config.yml` will be used.</span><br><span class="line">  copyright:</span><br><span class="line"></span><br><span class="line">  # Powered by Hexo &amp; NexT</span><br><span class="line">  powered: false</span><br><span class="line"></span><br><span class="line">  # Beian ICP and gongan information for Chinese users. See: https://beian.miit.gov.cn, http://www.beian.gov.cn</span><br><span class="line">  beian:</span><br><span class="line">    enable: false</span><br><span class="line">    icp:</span><br><span class="line">    # The digit in the num of gongan beian.</span><br><span class="line">    gongan_id:</span><br><span class="line">    # The full num of gongan beian.</span><br><span class="line">    gongan_num:</span><br><span class="line">    # The icon for gongan beian. See: http://www.beian.gov.cn/portal/download</span><br><span class="line">    gongan_icon_url:</span><br><span class="line"></span><br><span class="line">symbols_count_time:</span><br><span class="line">  separated_meta: true</span><br><span class="line">  item_text_post: true</span><br><span class="line">  item_text_total: true</span><br><span class="line"></span><br><span class="line">codeblock:</span><br><span class="line">  # Code Highlight theme</span><br><span class="line">  # All available themes: https://theme-next.js.org/highlight/</span><br><span class="line">  theme:</span><br><span class="line">    light: default</span><br><span class="line">    dark: tomorrow-night</span><br><span class="line">  prism:</span><br><span class="line">    light: prism</span><br><span class="line">    dark: prism-dark</span><br><span class="line">  # Add copy button on codeblock</span><br><span class="line">  copy_button:</span><br><span class="line">    enable: true</span><br><span class="line">    # Available values: default | flat | mac</span><br><span class="line">    style:</span><br><span class="line"></span><br><span class="line">back2top:</span><br><span class="line">  enable: true</span><br><span class="line">  # Back to top in sidebar.</span><br><span class="line">  sidebar: false</span><br><span class="line">  # Scroll percent label in b2t button.</span><br><span class="line">  scrollpercent: true</span><br><span class="line"></span><br><span class="line">busuanzi_count:</span><br><span class="line">  enable: true</span><br><span class="line">  total_visitors: true</span><br><span class="line">  total_visitors_icon: fa fa-user</span><br><span class="line">  total_views: false</span><br><span class="line">  total_views_icon: fa fa-eye</span><br><span class="line">  post_views: true</span><br><span class="line">  post_views_icon: far fa-eye</span><br><span class="line"></span><br><span class="line">local_search:</span><br><span class="line">  enable: true</span><br><span class="line">  # If auto, trigger search by changing input.</span><br><span class="line">  # If manual, trigger search by pressing enter key or search button.</span><br><span class="line">  trigger: auto</span><br><span class="line">  # Show top n results per article, show all results by setting to -1</span><br><span class="line">  top_n_per_article: 1</span><br><span class="line">  # Unescape html strings to the readable one.</span><br><span class="line">  unescape: false</span><br><span class="line">  # Preload the search data when the page loads.</span><br><span class="line">  preload: false</span><br><span class="line"></span><br><span class="line"># cursor_effect:</span><br><span class="line">#   enabled: true</span><br><span class="line">#   type: fireworks  # fireworks：礼花 | explosion：爆炸 | love：浮出爱心 | text：浮出文字</span><br><span class="line">cursor_effect: text</span><br></pre></td></tr></tbody></table></figure>

<p>认真看是不是还少了什么？</p>
<p>对了，背景动态火柴棍没了。。。。</p>
<p>记得这个效果是怎么实现的吗？是通过 git clone 本插件到 <code>next/source/lib</code> 中。根据 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://theme-next.js.org/docs/getting-started/upgrade.html">Upgrade</a> 所说：</p>
<blockquote>
<p>Since v8.0.0, all libraries under the <code>next/source/lib</code> directory was moved out to <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/next-theme/plugins">@next-theme/plugins</a>. Please see this article for the new 3rd-party libraries installation method: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://theme-next.js.org/docs/third-party-services/#Adding-Plugins">Adding Plugins</a>.</p>
</blockquote>
<p>但我查了一下这个库，发现也没有 <code>canvas_nest</code>，看来多半是被 delete 了。</p>
<p>没关系，我们还有大力出奇迹（</p>
<p>找到 <code>canvas_nest</code>的 github 库：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/theme-next">theme-next</a>/<strong><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/theme-next/theme-next-canvas-nest">theme-next-canvas-nest</a></strong></p>
<p>按说明行事：</p>
<ol>
<li><p>在 <code>hexo/source/_data</code> 中新建 <code>footer.njk</code>（不是 <code>footer.swig</code> 哦）。</p>
<blockquote>
<p> 由于 NexT 以前使用的 swig 模版引擎停止维护，去年迁移到了 Nunjucks</p>
</blockquote>
</li>
<li><p>加入以下内容</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script color="120,120,120" opacity="0.5" zIndex="-1" count="150" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"&gt;&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>（修改了一下，和原来我们在主题配置文件中实现的效果一致，就是不能单独设置移动端是否显示了）</p>
</li>
<li><p>在 <code>_config.next.yml</code> 解除 <code>footer: source/_data/footer.njk</code> 的注释（上面的参考代码中我已经开了）。</p>
</li>
</ol>
<p>即可。</p>
<p>话说回来记得我们另一个大力出奇迹的功能是啥么？回去复习~（还好我选择了放在 hexo 根目录的方法，否则这个功能也要再折腾一边）</p>
<p>关于其他的更新功能和差异，及迁移方法，可以查阅：</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/next-theme/hexo-theme-next/issues/4">【必读】更新说明及常见问题 #4</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://theme-next.js.org/docs/getting-started/upgrade.html">Upgrade</a></li>
</ul>
<p>更新后 NexT 仍自带，可通过编辑配置启用的功能模块：</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://theme-next.js.org/docs/third-party-services/#Adding-Plugins">Third-party Services</a></li>
</ul>
<h2 id="评论（临时）"><a href="#评论（临时）" class="headerlink" title="评论（临时）"></a>评论（临时）</h2><p>上次我看了几个评论系统。一开始打算用简单而泛用的 Valine。结果刚开始我发现注册账号需要手机号码而且后续还要实名就感觉这玩意不对，后续在 NexT 更新公告里面看见这么一段：</p>
<blockquote>
<p>Valine 评论系统出现了一些令人担忧的问题：</p>
<ul>
<li>NexT 团队曾多次收到关于 Valine 评论系统存在隐私泄露问题的反馈；</li>
<li>Valine 自 1.4 版本起不再开源，因此 NexT 团队无法对 Valine 评论系统 Debug。并且发布的打包版本中存在未告知用户的百度统计代码；</li>
<li>11 月下旬出现了针对 Valine 评论系统的攻击。</li>
</ul>
<p>考虑到这些问题已经严重影响到 NexT 用户的数据安全，我们决定将其移除，需要继续使用的用户请安装插件： <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/next-theme/hexo-next-valine">https://github.com/next-theme/hexo-next-valine</a><br>（插件的配置项使用驼峰命名，与 Valine 本身一致，需要注意将 <code>appid</code> 和 <code>appkey</code> 改为 <code>appId</code> 和 <code>appKey</code>）<br>鉴于以上原因，如果在使用 Valine 时出现<em>任何</em>问题，请在这里反馈： <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/xCss/Valine/issues">https://github.com/xCss/Valine/issues</a><br>迁移到 Disqus： <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/YunYouJun/valine-to-disqus">https://github.com/YunYouJun/valine-to-disqus</a></p>
</blockquote>
<p>怕了。另外的呢？接着就是上面我说的 gitment，我试了半天没用，开启后文章底下啥都出不来。后来发现这玩意是 2018 年更新的了。。。以及依赖 github Oauth Apps 的评论系统，调查了一下可能有安全问题（虽然参考文章都是两年前一年前的了，但配置文件中 secret 显然还是用的明码）：</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://henryhou.com/post/gitment_and_gittalk_secure/">评论插件 gitment 和 gittalk 存在安全性问题</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.v2ex.com/t/535608">建议大家弃用 Gitalk 和 Gitment 等权限过高的 Github OAuth App</a></li>
</ul>
<p>我关注的大佬里面有用 Disqus 的，比如 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.ichr.me/">ChrAlpha’s Blog</a>：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.ichr.me/post/use-disqus-conveniently/">在特殊地区科学使用 Disqus 评论系统</a>。不过我瞄了一眼，似乎挺复杂的样子。。。。以后再说。</p>
<p>依赖 github issue 的评论系统虽然有安全问题，但我也有小号啊 ~ 在小号上开应该安全许多，这类型的还有另一个选择：gitalk，先用着吧。</p>
<p>参考文章：</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://segmentfault.com/a/1190000014085547">为Hexo添加Gitalk评论插件</a></li>
</ul>
<ol>
<li><p>先安装</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gitalk</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>去小号那里创建一个 OAuth Apps</p>
<p>打开 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/settings/applications/new">New OAuth App</a>（从头像 -&gt;settings-&gt;Developer settings 这里也可以找到）。</p>
<p>新建一个。（不要慌填错后续还能改）</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20201222005052.png"></p>
<p>在稍后的界面获取一个 client secret，和 client id 一起记着待会要用。</p>
</li>
<li><p>打开主题配置文件（现在是 <code>_config.next.yml</code> 啦），新增</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">gitalk:</span><br><span class="line">  enable: true #用来做启用判断可以不用</span><br><span class="line">  owner: #Github 用户名,填小号的不要填大号的</span><br><span class="line">  repo: #储存评论issue的github仓库名</span><br><span class="line">  admin: #Github 用户名,</span><br><span class="line">  clientID: #`Github Application clientID`</span><br><span class="line">  clientSecret: #`Github Application clientSecret`</span><br><span class="line"> gitalk:</span><br><span class="line">  enable: true</span><br><span class="line">  github_id:  # GitHub repo owner，即小号的用户名</span><br><span class="line">  repo:  # Repository name to store issues，储存评论issue的github仓库名</span><br><span class="line">  client_id:  # GitHub Application Client ID，刚获取的</span><br><span class="line">  client_secret:  # GitHub Application Client Secret，刚获取的</span><br><span class="line">  admin_user:  # GitHub repo owner and collaborators, only these guys can initialize gitHub issues，还是填小号的用户名</span><br><span class="line">  distraction_free_mode: true # Facebook-like distraction free mode</span><br><span class="line">  # Gitalk's display language depends on user's browser or system environment</span><br><span class="line">  # If you want everyone visiting your site to see a uniform language, you can set a force language value</span><br><span class="line">  # Available values: en | es-ES | fr | ru | zh-CN | zh-TW</span><br><span class="line">  language:ok，</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>ok，接下来部署到网站后看到文章下面就有评论区了，登录自己的小号就能开启评论区，注意每个文章都需要手动开启。另外连 about 和 tags 那几个界面都有评论区。。。。我们可以在那几个文章的文前代码块里面加上</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">comments: false</span><br></pre></td></tr></tbody></table></figure>

<p>即可屏蔽掉那些文章的评论区。</p>
<h2 id="链接中中文转拼音，以及修改-permalinks"><a href="#链接中中文转拼音，以及修改-permalinks" class="headerlink" title="链接中中文转拼音，以及修改 permalinks"></a>链接中中文转拼音，以及修改 permalinks</h2></li>
</ol>
<p>参考文章：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/123286944">Github+Hexo+matery 博客搭建小白教程 - 知乎</a></p>
<blockquote>
<p>如果你的文章名称是中文的，那么 Hexo 默认生成的永久链接也会有中文，这样不利于 <code>SEO</code>，且 <code>gitment</code> 评论对中文链接也不支持。</p>
</blockquote>
<p>还有一点：Permalinks 我直接设置的日记文件标题（便于 seo），其实我的日记文件标题也就是当天的日期。不经任何修改可猜到可碰撞的网站一级目录文件，vps 文件漏洞 ptsd 警告（</p>
<p><del>其实我想找能够混淆 url 的 hexo 插件，没找到，先用这个凑合一下（</del>（可以使用 hexo-abbrlink，参考 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/nineya_com/article/details/103445898">hexo博客进阶（一）url设置和百度url提交、百度访问量统计_玖涯博客-CSDN博客</a>）</p>
<p>安装</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-permalink-pinyin</span><br></pre></td></tr></tbody></table></figure>

<p>在全局配置文件 <code>_config.yml</code> 新增：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">permalink_pinyin:</span><br><span class="line">  enable: true</span><br><span class="line">  separator: '-' # default: '-'</span><br></pre></td></tr></tbody></table></figure>

<p>后续，我研究了一下 permalinks，可以用文章标题代替文件标题的 url 部分。参考：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://hexo.io/zh-cn/docs/permalinks.html">永久链接（Permalinks） | Hexo</a></p>
<p>修改全局配置文件</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">permalink: :post_title/</span><br></pre></td></tr></tbody></table></figure>

<p>甚至还可以加上 hash 值（但可能对 seo 产生副作用）</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">permalink: :post_title-:hash/</span><br></pre></td></tr></tbody></table></figure>

<p>修改后需要刷新</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean&amp;&amp;hexo g</span><br></pre></td></tr></tbody></table></figure>

<h2 id="RSS"><a href="#RSS" class="headerlink" title="RSS"></a>RSS</h2><p>参考文章：</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://steemit.com/cn/@greedyboy/hexo-next-rss">将hexo静态博客next主题安装rss插件功能 — Steemit</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.zywvvd.com/2020/03/20/next/14_add_rss/next-add-rss/">Next -14- 为Hexo Next7.7.1 添加RSS （带按钮） | 又见苍岚</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://suyin-blog.club/2020/2M3YWE7/">给 Hexo 中的 Next 主题添加 RSS 功能 | 苏寅 Blog</a></li>
</ul>
<p>安装 rss 插件：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-generator-feed</span><br></pre></td></tr></tbody></table></figure>

<p>在全局配置文件中新增：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">feed:</span><br><span class="line">    type: atom</span><br><span class="line">    path: atom.xml</span><br><span class="line">    limit: 20 #展示文章的数量，使用 0 或则 false 代表展示全所有的帖子</span><br><span class="line">    #content: #（可选）设置 true 可以在 RSS 文件中包含文章全部内容，默认：false</span><br><span class="line">    content_limit:300 #（可选）摘要中使用的帖子内容的默认长度。 仅在内容设置为 false 且未显示自定义帖子描述时才使用。</span><br><span class="line">    #content_limit_delim: #（可选）开启content_limit时，在显示的帖子内容中如果有分隔符，优先按分隔符进行分割。默认不使用。</span><br><span class="line">    #order_by: -date #rss 文章排序方法</span><br></pre></td></tr></tbody></table></figure>

<p>之后有三种显示方法（可以同时开启，但 2 和 3 没必要一起开）：</p>
<ol>
<li><p>显示在每篇文章末尾。这是 next 默认情况下推荐的方法，在 next 文件夹原来的配置文件中可以找到。</p>
<p>在主题配置文件 <code>_config.next.yml</code> 中新增</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">follow_me:</span><br><span class="line">  #Twitter: https://twitter.com/包包包zb || fab fa-twitter</span><br><span class="line">  #Telegram: https://t.me/channel_name || fab fa-telegram</span><br><span class="line">  #WeChat: /images/wechat_channel.jpg || fab fa-weixin</span><br><span class="line">  RSS: /atom.xml || fa fa-rss</span><br></pre></td></tr></tbody></table></figure>

<p>效果如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104030713.png"></p>
</li>
<li><p>和侧边栏的联系方式显示在一起</p>
<p>修改主题配置文件中的 <code>social</code> 项：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">social:</span><br><span class="line">  ...</span><br><span class="line">  RSS: /atom.xml || fa fa-rss</span><br></pre></td></tr></tbody></table></figure>

<p>效果如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104030940.png"></p>
</li>
<li><p>（不太推荐，因为和侧边栏动画无法统一）显示在侧边栏中部</p>
<p>修改 <code>\themes\next\layout\_partials\sidebar\site-overview.njk</code></p>
<p>在 <code>{%- if theme.site_state %}</code> 前新增</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">{% if theme.rss %}</span><br><span class="line">   &lt;div class="feed-link motion-element"&gt;</span><br><span class="line">     &lt;a href="{{ url_for(theme.rss) }}" rel="alternate"&gt;</span><br><span class="line">       &lt;i class="fa fa-rss"&gt;&lt;/i&gt;</span><br><span class="line">       RSS</span><br><span class="line">     &lt;/a&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">{% endif %}</span><br><span class="line"></span><br><span class="line">{%- if theme.site_state %}</span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure>

<p>然后在主题配置文件中添加</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rss: /atom.xml</span><br></pre></td></tr></tbody></table></figure>

<p>效果如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104031356.png"></p>
</li>
</ol>
<p>修改完后需要刷新，此时查看 public 文件夹中应该正确生成 atom.xml。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean&amp;&amp;hexo g</span><br></pre></td></tr></tbody></table></figure>

<h2 id="显示运行时间"><a href="#显示运行时间" class="headerlink" title="显示运行时间"></a>显示运行时间</h2><p>参考文章：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://yansheng836.github.io/article/50902a4.html">hexo+yilia添加网站运行时间，ICP备案信息，设定站点建立时间 | 荷塘月色的博客</a></p>
<p>在 <code>source\_data\footer.njk</code> 中添加：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--《添加网站运行时间 --&gt;</span><br><span class="line">&lt;!--&lt;br/&gt;--&gt;</span><br><span class="line">&lt;span id="timeDate"&gt;载入天数...&lt;/span&gt;&lt;span id="times"&gt;载入时分秒...&lt;/span&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var now = new Date();</span><br><span class="line"></span><br><span class="line">    function createtime() {</span><br><span class="line">        var grt = new Date("07/25/2019 12:00:00"); //此处修改你的建站时间或者网站上线时间 </span><br><span class="line">        now.setTime(now.getTime() + 250);</span><br><span class="line">        days = (now - grt) / 1000 / 60 / 60 / 24;</span><br><span class="line">        dnum = Math.floor(days);</span><br><span class="line">        hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);</span><br><span class="line">        hnum = Math.floor(hours);</span><br><span class="line">        if (String(hnum).length == 1) {</span><br><span class="line">            hnum = "0" + hnum;</span><br><span class="line">        }</span><br><span class="line">        minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);</span><br><span class="line">        mnum = Math.floor(minutes);</span><br><span class="line">        if (String(mnum).length == 1) {</span><br><span class="line">            mnum = "0" + mnum;</span><br><span class="line">        }</span><br><span class="line">        seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);</span><br><span class="line">        snum = Math.round(seconds);</span><br><span class="line">        if (String(snum).length == 1) {</span><br><span class="line">            snum = "0" + snum;</span><br><span class="line">        }</span><br><span class="line">        document.getElementById("timeDate").innerHTML = " 本站已安全运行 " + dnum + " 天 "; //去掉了一个分隔符竖杠，因为用了不算子，已经自动做了换行分割</span><br><span class="line">        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";</span><br><span class="line">    }</span><br><span class="line">    setInterval("createtime()", 250);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;!-- 添加网站运行时间》 --&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>即参考文章中的「硬性配置」。</p>
<p>另外参考文章中有所谓「灵活配置」，将开关和建站时间设定提取成主题配置文件的配置项。但亲测使用灵活配置还得修改主题配置文件夹，修改放在全局配置文件夹的 <code>footer.njk</code> 不生效，不符合我们迁移时说的「不修改主题文件夹」的思想。</p>
<p>还有就是。我以为判断运行时间是会有更高级的方法，比如调用什么接口测试你的网站是啥时候开的，什么时候第一次部署的什么的，没想到是手工设置，和我的设想还是有点出入。。。</p>
<h2 id="评分"><a href="#评分" class="headerlink" title="评分"></a>评分</h2><p>参考文章：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.zhyong.cn/posts/fc22/">hexo-next 添加文章置顶功能和评分功能等 | YouForever</a></p>
<p>在主题配置文件中添加</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rating:</span><br><span class="line">  enable: true</span><br><span class="line">  id:</span><br><span class="line">  color:  "#fc6423"</span><br></pre></td></tr></tbody></table></figure>

<p>其中的 id，需要到 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://widgetpack.com/">widgetpack</a> 新建一个账号，新建完在左上角有显示。</p>
<p>建议配置评分方式，侧栏 &gt; Rating &gt; Setting，建议用 IP address 或 Device (cookie)，免登录。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104032640.png"></p>
<h2 id="markdown-emoji"><a href="#markdown-emoji" class="headerlink" title="markdown emoji"></a>markdown emoji</h2><p>参考文章：</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/crimx/hexo-filter-github-emojis">crimx/hexo-filter-github-emojis: github emojis for hexo!</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://spacefan.github.io/2018/06/30/hexo-emoji/">Hexo 博客使用 emoji 表情 | Home</a></li>
</ul>
<p>安装：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-filter-github-emojis</span><br></pre></td></tr></tbody></table></figure>

<p>在全局配置文件中新增：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">githubEmojis:</span><br><span class="line">  enable: true</span><br><span class="line">  className: github-emoji</span><br><span class="line">  inject: true</span><br><span class="line">  #unicode: true #这个参数我也不知道加不加，出问题再说</span><br><span class="line">  styles:</span><br><span class="line">  customEmojis:</span><br></pre></td></tr></tbody></table></figure>

<p>修改完之后需要刷新。</p>
<p>不过，对于目前我的浏览器这个插件有个小 bug：</p>
<p> 目前的效果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210113073831.png"></p>
<p>看起来不错。其实还有一个狗头：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210113073930.png"></p>
<p>只要选中就出现了。不知道是插件的效果还是 github 表情本身就有这个效果（我没用过不知道），挺好玩。。。但这个效果是在干净的 edge 上才能显示出来，在我配置过字体 stylus 的 centbrowser 这里就出问题了：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210113074220.png"></p>
<p>我想暂时先关掉这个变来变去的彩蛋，只显示一种狗头就好了，然而找不到方法，就先不管了，反正停掉一个单一网页的字体优化就一个选框的事。</p>
<p>我也试了一下另一个插件<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/theme-next/hexo-filter-emoji">theme-next/hexo-filter-emoji: 🎉 GitHub emojis for Hexo!</a>，也能生效，但会出问题，无论我换不换字体，不选择时的狗头都出不来，只有选中时候的狗头才出现，这就属于「不能用」的情况了。</p>
<h2 id="修改正文字体大小"><a href="#修改正文字体大小" class="headerlink" title="修改正文字体大小"></a>修改正文字体大小</h2><p>感觉正文有一丢丢大。不过按照 Next 主题配置文件内的 fonts 属性配置（可参考 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://theme-next.js.org/docs/theme-settings/miscellaneous.html?highlight=fonts+customization">Misc Theme Settings | NexT</a>），发现没法单独修改正文字体的大小。</p>
<p>后来偶然发现开调试的时候，正文的字体大小是 1.125em：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210217072142.png"></p>
<p>对应的是 <code>$font-size-large</code> 这个属性（参考 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/dpdpdppp/article/details/102387532">hexo(Next主题)修改文字大小_dpdpdppp的博客-CSDN博客</a>）</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// Font size</span><br><span class="line">$font-size-base           = 1em;</span><br><span class="line">$font-size-base           = unit(hexo-config('font.global.size'), em) if hexo-config('font.global.size') is a 'unit';</span><br><span class="line">$font-size-smallest       = .75em;</span><br><span class="line">$font-size-smaller        = .8125em;</span><br><span class="line">$font-size-small          = .875em;</span><br><span class="line">$font-size-medium         = 1em;</span><br><span class="line">$font-size-large          = 1.125em;</span><br><span class="line">$font-size-larger         = 1.25em;</span><br><span class="line">$font-size-largest        = 1.375em;</span><br></pre></td></tr></tbody></table></figure>

<p>于是，修改主题配置文件，取消 <code>custom_file_path</code> 代码块中的 <code> variable: source/_data/variables.styl</code> 这行注释。然后在 <code>source/_data/</code>中新建 <code>variables.styl</code>，添加：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$font-size-large = 1.05em</span><br></pre></td></tr></tbody></table></figure>

<p>即可。</p>
<p>但这时又发现标题的字体大小不够了。。。这回没辙了，标题大小单独写死在主题中没法覆盖（优先级仅次于带 $ 号的全局字体属性比如上面这个，高于 h1 这种标签，所以改 h1 也不成），除非修改主题文件夹中某个文件的 <code>.posts-expand .post-title</code> 这一段属性，算了算了。</p>
<h2 id="谷歌百度搜索收录"><a href="#谷歌百度搜索收录" class="headerlink" title="谷歌百度搜索收录"></a>谷歌百度搜索收录</h2><p>参考文章：</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.jianshu.com/p/f8ec422ebd52">Hexo博客提交百度和Google收录 - 简书</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.yuan-ji.me/Hexo-%E4%BC%98%E5%8C%96%EF%BC%9A%E6%8F%90%E4%BA%A4sitemap%E5%8F%8A%E8%A7%A3%E5%86%B3%E7%99%BE%E5%BA%A6%E7%88%AC%E8%99%AB%E6%8A%93%E5%8F%96-GitHub-Pages-%E9%97%AE%E9%A2%98/">Hexo 优化：提交 sitemap 及解决百度爬虫无法抓取 GitHub Pages 链接问题 | JI’s Blog</a></li>
</ul>
<h3 id="谷歌"><a href="#谷歌" class="headerlink" title="谷歌"></a>谷歌</h3><p>谷歌最简单，而且也不需要实名。而且。。。听说只要时间一长，google 的爬虫会自动把你的页面爬进去，根本不用申请。不过我比较猴急，我现在！马上！就要在谷歌娘身体里面看到我的痕迹（滴嘟滴嘟</p>
<ol>
<li><p>安装谷歌站点地图生成工具</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-generator-sitemap</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>在全局配置文件中添加</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#hexo sitemap</span><br><span class="line">sitemap:</span><br><span class="line">  path: sitemap.xml</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>刷新，此时查看 public 文件夹中应该正确生成 sitemap.xml</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean&amp;&amp;hexo g</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>访问<a target="_blank" rel="external nofollow noopener noreferrer" href="https://search.google.com/search-console/">欢迎使用 Google Search Console</a>，除非绑定了自己的域名，否则在网址前缀中输入博客主页 url（带 https），即 <code>https://xxx.github.io</code>。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104051916.png"></p>
</li>
<li><p>然后谷歌会给你一个文件。用文本编辑器打开，在最开头加上</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">layout: false</span><br><span class="line">sitemap: false</span><br><span class="line">---</span><br></pre></td></tr></tbody></table></figure>

<p>然后把这个文件放到 hexo 的 <code>_posts</code> 文件夹中，部署 <code>hexo d -g</code>。</p>
</li>
<li><p>大概要过段时间（因为一个我们用的 github 静态博客同步没那么快，二个谷歌本身就没那么快，我大概等了一个小时左右），此时再进这里就会进入 Google Search Console 网站管理界面了。</p>
</li>
<li><p>（可选）趁等待谷歌反应过来的间隙，继续优化一下。使用 nofollow，大概意思是自动判断出索引黑名单，不爬取黑名单的页面。</p>
<p>安装</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-autonofollow</span><br></pre></td></tr></tbody></table></figure>

<p>在全局配置文件中添加</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nofollow:</span><br><span class="line">    enable: true</span><br><span class="line">    exclude: # 不添加 nofollow 标签的连接</span><br><span class="line">    - exclude1.com</span><br><span class="line">    - exclude2.com</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>（可选）添加 rebot.txt。大概意思是使用规则判断索引黑白名单。在 <code>source/</code>文件夹下新建一个 rebots.txt 文件，放入以下内容：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># hexo robots.txt</span><br><span class="line">User-agent: *</span><br><span class="line">Allow: /</span><br><span class="line">Allow: /archives/</span><br><span class="line"></span><br><span class="line">Disallow: /vendors/</span><br><span class="line">Disallow: /js/</span><br><span class="line">Disallow: /css/</span><br><span class="line">Disallow: /fonts/</span><br><span class="line">Disallow: /vendors/</span><br><span class="line">Disallow: /fancybox/</span><br><span class="line"></span><br><span class="line">Sitemap: http://xxx.github.io/sitemap.xml</span><br><span class="line">Sitemap: http://xxx.github.io/baidusitemap.xml</span><br></pre></td></tr></tbody></table></figure>

<p>然后刷新，部署。</p>
</li>
<li><p>在索引-&gt;站点地图-&gt;输入站点地图地址，填入 <code>sitemap.xml</code>，有可能马上提示成功，也可能提示失败。失败的话估计要等个半天一天再过来看，如果还失败就重新提交，我是提交到第三次就显示成功了。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210104052701.png"></p>
</li>
<li><p>在 google 中输入 <code>site:xxxx.github.io</code>，如果显示搜不到，稍安勿躁，估计又是要等个一两天半周的。</p>
</li>
<li><p><strong>（21.1.21）</strong>后续我更新了一下网站结构，十多天过去了，google 没读取我新的站点地图，得手动刷新。方法是到覆盖率中，找到任意一个 404 的网页，点击已解决。</p>
</li>
</ol>
<h3 id="百度（存疑）"><a href="#百度（存疑）" class="headerlink" title="百度（存疑）"></a>百度（存疑）</h3><p>我自己没有亲自实验过，但听说 baidu 搜索引擎是没办法爬 <code>github.io</code> 的，说是百度爬的太多被 github 官方 ban 了。解决方法有三种：</p>
<ul>
<li>双线部署。部署到 coding 或者 gitlab 上。coding 被腾讯收购了，速度有保障，但要实名啥的，好像还要域名；gitlab 不需要手机号啥的，但访问速度比 github 还要不乐观。可以参考 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/111796666">Hexo 双线部署到 Coding 和 GitHub 提升访问速度 - 知乎</a>。</li>
<li>镜像部署，我现在用的是这种。参考<a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/111773896">如何让百度收录 GitHub Pages 个人博客 - 知乎</a>。部署到 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://vercel.com/">Vercel</a> 上，当检测到 github 仓库更新，vercel 这边也会自动重新拉取并部署。自带 cdn 也能保证速度，部署起来比前一种方便，缺点就是每个月只有 20G 访问流量，目前对于我这种小透明博客也够用了；还有就是注册的时候还是要用到手机号的。</li>
<li>使用主动推送。即部署时通过插件主动提交网页给搜索引擎。</li>
</ul>
<p><strong>前两种方法统称为使用镜像站点。使用镜像站点的方法和使用主动推送的方法是有一定冲突的。因为主动推送推送给搜索引擎的域名是以全局配置文件开头的 <code>url</code> 参数为准，而 <code>url</code> 参数中只能写一个域名，所以此时只能选谷歌 / 百度其中一个引擎做主动推送。同时，使用镜像站还需要使用「侵入式」方法修改站点地图模块生成的 url，否则其中一个站点地图就会出错。</strong>打个比方，全局配置文件开头的 <code>url</code> 我们写的是 github.io 的域名，也就是主站域名。此时生成的给百度的站点目录和主动推送域名也都是关于主站的而不是镜像站的，但百度那边我们填的是镜像站的域名，这就乱套了。另外将 <code>url</code> 修改为镜像站域名，直觉告诉我，未来有可能会引发什么其他的依赖于 url 插件的 bug。唯一一个能让镜像站和主动推送完美共存的方法就是通过 cname 链接到同一个自己的域名上，这就超出本文的研究范围了，不做探讨。</p>
<h4 id="不使用镜像站，仅使用主动推送提交页面"><a href="#不使用镜像站，仅使用主动推送提交页面" class="headerlink" title="不使用镜像站，仅使用主动推送提交页面"></a>不使用镜像站，仅使用主动推送提交页面</h4><ol>
<li><p>打开<a target="_blank" rel="external nofollow noopener noreferrer" href="https://ziyuan.baidu.com/">百度搜索资源平台</a>，注册啥的我就略过了，注册完毕点击普通收录，在输入网站界面，协议选择 https 并输入我们的 <code>xxx.github.io</code> 域名，站点属性这里看实际情况选几个分类，然后验证网站这里选文件验证，下载。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210124015247.png"></p>
</li>
<li><p>和谷歌那边一样，获得的文件用文本编辑器打开，在最开头加上</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">layout: false</span><br><span class="line">sitemap: false</span><br><span class="line">---</span><br></pre></td></tr></tbody></table></figure>

<p>然后把这个文件放到 hexo 的 <code>_posts</code> 文件夹中，部署 <code>hexo d -g</code>。</p>
</li>
<li><p>同样，和 google 那边一样，过段时间再回来再点完成验证。实测百度这里的响应时间要比谷歌快得多，但。。。点完完成验证多半会进入 https 认证界面告诉你验证失败，这时点击再次验证，多半还会告诉你验证失败，不用管，估计过半天回来就成功了，好家伙，原来比谷歌快的真相是 https 验证耗得时间放到这里来了。。。不过，好消息是，我们不用等待它 https 验证完毕就可以下一步了。</p>
</li>
<li><p>配置主动推送模块。有两种选择，一个是 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/huiwang/hexo-baidu-url-submit">hexo-baidu-url-submit</a>，这个模块比较老但挺稳定，只用于百度主动推送；另一个是 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/cjh0613/hexo-submit-urls-to-search-engine">hexo-submit-urls-to-search-engine</a>，能同时用于 google / 必应的推送，但我第一次搞就报错了。。。所以我现在只用前一个。</p>
<p>在刚刚 sitemap 位置的旁边，有个 api 提交，下面就有个接口调用地址，把地址中 <code>token=</code> 后面的内容记下来。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210124025621.png"></p>
<p>安装百度主动推送插件</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-baidu-url-submit</span><br></pre></td></tr></tbody></table></figure>

<p>在全局配置文件中新增：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">baidu_url_submit:</span><br><span class="line">  count: 100                 # 提交最新的多少个链接</span><br><span class="line">  host:                      # 在百度站长平台中添加的域名</span><br><span class="line">  token:                     # 秘钥</span><br><span class="line">  path: baidu_urls.txt</span><br></pre></td></tr></tbody></table></figure>

<p>并修改全局配置文件中 deploy 对应代码块，将原来的：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: git@github.com:xxx/xxx.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></tbody></table></figure>

<p>改成</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  - type: git</span><br><span class="line">    repository: git@github.com:xxx/xxx.github.io.git</span><br><span class="line">    branch: master</span><br><span class="line">  - type: baidu_url_submitter</span><br></pre></td></tr></tbody></table></figure>

<p>重新部署即可。</p>
</li>
</ol>
<p><strong>（21.2.26 更新）</strong> 照上面的一通做下来：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210226061535.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210226061627.png"></p>
<p>啊这。。。我明明提交的是后面这个网站呀？</p>
<h4 id="使用镜像站"><a href="#使用镜像站" class="headerlink" title="使用镜像站"></a>使用镜像站</h4><ol>
<li><p>两种镜像站只简单写写我用的这种，也就是第二种。打开 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://vercel.com/">Vercel</a>，注册一个账号后关联自己的 github，导入博客的 repo，后面部署的选项维持默认即可，注意 <code>FRAMEWORK PRESET</code> 这里不要选择 hexo，维持 other 即可。部署需要一定时间，部署完一切正常的话，点开 view build logs 应该是这样的：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210124021027.png"></p>
<p>此时 domains 那里应该有三个域名，挑其中一个域名记着待会备用。</p>
</li>
</ol>
<p>2-4. 参考不使用镜像站时的 1-3 步，差别就是填入的域名从 <code>xxx.github.io</code> 改为刚刚我们获得的镜像站域名。</p>
<ol start="5">
<li><p>安装百度站点地图生成工具</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-generator-baidu-sitemap</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>在全局配置文件中添加</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#hexo sitemap</span><br><span class="line">sitemap:</span><br><span class="line">  path: baidusitemap.xml</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>此时就需要进行抉择：</p>
<ul>
<li>修改百度站点地图生成工具代码，使其不依赖全局配置文件 url 独立生成镜像站 url 的站点配置。不需要修改全局配置文件的 url，只能兼容谷歌的主动推送工具。</li>
<li>修改全局配置文件 url 为镜像站 url；修改谷歌站点地图生成工具代码，使其不依赖全局配置文件 url 独立生成主站 url 的站点配置。只能兼容百度的主动推送工具，修改全局配置文件 url 可能未来会出现未知 bug。</li>
</ul>
<p>参考<a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/31411755">修改hexo sitemap 生成插件中的链接模板 - 知乎</a>。</p>
<ul>
<li><p>修改百度站点地图生成工具代码：</p>
<p>定位到 <code>hexo\node_modules\hexo-generator-baidu-sitemap</code>，打开 <code>baidusitemap.ejs</code>，找到</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;loc&gt;&lt;%- encodeURI(url + post.path) %&gt;&lt;/loc&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>修改为类似于</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;loc&gt;&lt;%- encodeURI("https://xxx.github.io/" + post.path) %&gt;&lt;/loc&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>即可。</p>
</li>
<li><p>修改谷歌站点地图生成工具代码:</p>
<p>谷歌这边就不用侵入式修改了，因为这个插件支持配合模板使用。</p>
<p>下载<a target="_blank" rel="external nofollow noopener noreferrer" href="https://raw.githubusercontent.com/hexojs/hexo-generator-sitemap/master/sitemap.xml">模板</a>，重命名为 sitemap_template.xml。放入 hexo 根目录。</p>
<p>找到以下内容：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;loc&gt;{{ post.permalink | uriencode }}&lt;/loc&gt;</span><br><span class="line"></span><br><span class="line">&lt;loc&gt;{{ config.url | uriencode }}&lt;/loc&gt;</span><br><span class="line"></span><br><span class="line">&lt;loc&gt;{{ tag.permalink | uriencode }}&lt;/loc&gt;</span><br><span class="line"></span><br><span class="line">&lt;loc&gt;{{ cat.permalink | uriencode }}&lt;/loc&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>依次修改为类似于下面的内容：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;loc&gt;{{ "https://xxx.github.io/" + post.path | uriencode }}&lt;/loc&gt;</span><br><span class="line"></span><br><span class="line">&lt;loc&gt;https://xxx.github.io/&lt;/loc&gt;</span><br><span class="line"></span><br><span class="line">&lt;loc&gt;{{ "https://xxx.github.io/" + tag.path | uriencode }}&lt;/loc&gt;</span><br><span class="line"></span><br><span class="line">&lt;loc&gt;{{ "https://xxx.github.io/" + cat.path | uriencode }}&lt;/loc&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>在全局配置文件中修改相应位置：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#hexo sitemap</span><br><span class="line">sitemap:</span><br><span class="line">  path: sitemap.xml</span><br><span class="line">  template: ./sitemap_template.xml</span><br></pre></td></tr></tbody></table></figure>

<p>重新部署即可。</p>
</li>
</ul>
</li>
<li><p>刷新，此时查看 public 文件夹中应该正确生成 baidusitemap.xml（和 sitemap.xml），可打开查看域名是否正确。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean&amp;&amp;hexo g</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>nofollow 和 robots.txt 之前部署谷歌收录的时候部署过了，在百度这里通用（除了 robots.txt 中百度站点地图的地址可能要改成镜像站地址），没有进行谷歌收录部署的可以往上翻谷歌部署的第 7、8 步；直接部署站点地图就好了。点站点管理页面左侧侧边栏的资源提交 -&gt; 普通提交 -&gt; sitemap，输入 <code>[镜像站名]/baidusitemap.xml</code>，提交即可。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zbpicture/picture@main/img/20210124023841.png"></p>
</li>
<li><p>（可选，仅 url 设置为镜像站域名时可用）配置主动提交。参考不使用镜像站时的第 4 步，区别只是全局配置中的相应 host 参数改为镜像站的。</p>
</li>
<li><p>（可选）许多参考文章还提到一个自动推送。但百度去年改过依次规则，域名已备案的才可使用自动推送，且相关接口（swig 文件）业已从 NexT 主题中删除。如有需要的可自己研究，这里不涉及。</p>
</li>
</ol>
<h2 id="加载速度优化"><a href="#加载速度优化" class="headerlink" title="加载速度优化"></a>加载速度优化</h2><h3 id="快速连接技术"><a href="#快速连接技术" class="headerlink" title="快速连接技术"></a>快速连接技术</h3><p>照抄文章：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://lvxuefei.top/%E5%88%A9%E7%94%A8Hexo-Next%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%89%EF%BC%89-%E4%BC%98%E5%8C%96-%E5%90%84%E7%A7%8Dtips%E3%80%81%E9%BB%91%E7%A7%91%E6%8A%80%EF%BC%8C%E4%B8%8D%E6%96%AD%E6%9B%B4%E6%96%B0/">利用 Hexo+Next 搭建个人博客（三）—— 优化 (各种 tips、黑科技，不断更新) | 槐雪</a></p>
<blockquote>
<p>什么是快速连接技术，下面是其 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/GoogleChromeLabs/quicklink">GitHub 源地址</a>上给出的解释：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通过在空闲时间预取视区内链接来加快后续页面加载速度</span><br></pre></td></tr></tbody></table></figure>

<p>按我的理解应该是在我们访问博文页面的时候，如果博文位于视区内的部分有网页链接，那么浏览器在空闲时会预加载该链接对应的页面以达到加快后续的访问速度的目的。</p>
</blockquote>
<p>安装</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i quicklink</span><br></pre></td></tr></tbody></table></figure>

<p>在主题配置文件中添加</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">quicklink:</span><br><span class="line">  enable: true</span><br></pre></td></tr></tbody></table></figure>

<h3 id="使用-Gulp-压缩静态资源"><a href="#使用-Gulp-压缩静态资源" class="headerlink" title="使用 Gulp 压缩静态资源"></a>使用 Gulp 压缩静态资源</h3><p>参考文章：<a target="_blank" rel="external nofollow noopener noreferrer" href="http://yifanstar.top/2020/07/19/hexo-blog-creat/">Hexo + GitHub Pages 搭建个人博客及 NexT 主题配置 | Star’s Tech Blog</a></p>
<p>看起来有点复杂。。。我得想办法先确认这些加速手段有用再继续，先占坑。</p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>zbttl
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://zbttl-github-io.vercel.app/hexo-jin-jie/" title="hexo 进阶">https://zbttl-github-io.vercel.app/hexo-jin-jie/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="/atom.xml">
          <span class="icon">
            <i class="fa fa-rss"></i>
          </span>

          <span class="label">RSS</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/hexo/" rel="tag"># hexo</a>
              <a href="/tags/NexT/" rel="tag"># NexT</a>
          </div>

        
  <div class="post-widgets">
    <div class="wp_rating">
      <div id="wpac-rating"></div>
    </div>
  </div>

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/hexo-ru-men/" rel="prev" title="hexo 入门">
                  <i class="fa fa-chevron-left"></i> hexo 入门
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/wan-yi-xia-ffmpeg/" rel="next" title="玩一下 FFmpeg">
                  玩一下 FFmpeg <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zbttl</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">336k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">10:11</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">本博客使用 <a href="https://hexo.io/" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a> 
  </div><script color="120,120,120" opacity="0.5" zindex="-1" count="150" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>
<!--《添加网站运行时间 -->
<!--<br/>-->
<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date();

    function createtime() {
        var grt = new Date("12/18/2020 12:00:00"); //此处修改你的建站时间或者网站上线时间 
        now.setTime(now.getTime() + 250);
        days = (now - grt) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if (String(hnum).length == 1) {
            hnum = "0" + hnum;
        }
        minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if (String(mnum).length == 1) {
            mnum = "0" + mnum;
        }
        seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if (String(snum).length == 1) {
            snum = "0" + snum;
        }
        document.getElementById("timeDate").innerHTML = " 本站已安全运行 " + dnum + " 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
    setInterval("createtime()", 250);
</script>
<!-- 添加网站运行时间》 -->

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
  <script>
  if (CONFIG.page.isPost) {
    wpac_init = window.wpac_init || [];
    wpac_init.push({
      widget: 'Rating',
      id    : 28813,
      el    : 'wpac-rating',
      color : '#fc6423'
    });
    (function() {
      if ('WIDGETPACK_LOADED' in window) return;
      WIDGETPACK_LOADED = true;
      var mc = document.createElement('script');
      mc.type = 'text/javascript';
      mc.async = true;
      mc.src = '//embed.widgetpack.com/widget.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
    })();
  }
  </script>
<script src="/js/local-search.js"></script>






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1.7.0/dist/gitalk.css">

<script>
NexT.utils.loadComments('#gitalk-container', () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1.7.0/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'd99d750bdfdb31ecf37e',
      clientSecret: '1d37215aff71dc84b66e03cb412c7e68b968d76f',
      repo        : 'zbttl-comment',
      owner       : 'zbpicture',
      admin       : ['zbpicture'],
      id          : 'e20290f21c6a41a192c78a00572da4a3',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

<script type="text/javascript" src=" https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script async src="/js/cursor/text.js"></script>




</body>
</html>
